[2026-02-16 01:56:00,117][root][INFO] - ğŸ“ é¡¹ç›®æ ¹ç›®å½•å®šä½: /tmp/pycharm_project_982
[2026-02-16 01:56:00,118][root][INFO] - âœ… å¼ºåˆ¶ä½¿ç”¨å• GPU è®­ç»ƒ
[2026-02-16 01:56:00,118][root][INFO] - æ£€æµ‹åˆ° 1 ä¸ªCUDAè®¾å¤‡å¯ç”¨
[2026-02-16 01:56:00,118][root][INFO] - ä½¿ç”¨GPUè¿›è¡Œè®­ç»ƒ
[2026-02-16 01:56:00,119][root][INFO] - ğŸ“¦ ä½¿ç”¨æ•°æ®é›†: CIC-IDS-2017
[2026-02-16 01:56:00,119][root][INFO] - ä½¿ç”¨è¿‡æ»¤ excluded_classes åçš„ flow æ•°æ®æ–‡ä»¶: /tmp/pycharm_project_982/processed_data/CIC-IDS-2017-session-srcIP_srcPort_dstIP_dstPort_proto/all_embedded_flow.filtered_port_53__svc_dns.filtered_Heartbleed_Infiltration.csv
[2026-02-16 01:56:00,119][root][INFO] - ä½¿ç”¨ merged_classes åçš„ flow æ•°æ®æ–‡ä»¶: /tmp/pycharm_project_982/processed_data/CIC-IDS-2017-session-srcIP_srcPort_dstIP_dstPort_proto/all_embedded_flow.filtered_port_53__svc_dns.filtered_Heartbleed_Infiltration.merged_Web_Attack.csv
[2026-02-16 01:56:00,119][root][INFO] - æ•°æ®æ¨¡å— setup é˜¶æ®µ: fit
[2026-02-16 01:56:00,119][root][INFO] - è¯»å–æ•°æ® ä» /tmp/pycharm_project_982/processed_data/CIC-IDS-2017-session-srcIP_srcPort_dstIP_dstPort_proto/all_embedded_flow.filtered_port_53__svc_dns.filtered_Heartbleed_Infiltration.merged_Web_Attack.csv...
[2026-02-16 01:56:00,119][root][INFO] - æ–‡ä»¶å¤§å°: 4.83 GB
[2026-02-16 01:56:00,128][root][INFO] - æ£€æµ‹åˆ° 381 åˆ—ï¼Œå¼€å§‹åˆ†å—è¯»å–...
[2026-02-16 01:57:12,195][root][INFO] - è¯»å–æ•°æ® å®Œæˆ! æ•°æ®å½¢çŠ¶: (908984, 381)
[2026-02-16 01:57:12,219][root][INFO] - æ£€æŸ¥ fit é˜¶æ®µæ•°æ®è´¨é‡ï¼ˆä»…æ£€æŸ¥ cfg ä¸­å¼•ç”¨çš„åˆ—ï¼‰...
[2026-02-16 01:57:12,304][root][WARNING] - âš ï¸ ä»¥ä¸‹ä½¿ç”¨åˆ°çš„ç‰¹å¾åˆ—åŒ…å« NaNï¼š
[2026-02-16 01:57:12,304][root][WARNING] -   x509.cert0.certificate.issuer: 781998 ä¸ª NaN (86.03%)
[2026-02-16 01:57:12,304][root][WARNING] -   dns.query: 566008 ä¸ª NaN (62.27%)
[2026-02-16 01:57:12,304][root][WARNING] -   ssl.server_name: 695546 ä¸ª NaN (76.52%)
[2026-02-16 01:57:12,304][root][WARNING] -   x509.cert0.certificate.subject: 781998 ä¸ª NaN (86.03%)
[2026-02-16 01:57:12,304][root][INFO] - fit é˜¶æ®µæ•°æ®è´¨é‡æ£€æŸ¥å®Œæˆï¼ˆä»…æ£€æŸ¥ cfg ä½¿ç”¨çš„åˆ—ï¼‰
[2026-02-16 01:57:12,304][root][INFO] - è¯»å–æ•°æ® ä» /tmp/pycharm_project_982/processed_data/CIC-IDS-2017-session-srcIP_srcPort_dstIP_dstPort_proto/all_split_session.csv...
[2026-02-16 01:57:12,304][root][INFO] - æ–‡ä»¶å¤§å°: 0.22 GB
[2026-02-16 01:57:12,307][root][INFO] - æ£€æµ‹åˆ° 55 åˆ—ï¼Œå¼€å§‹åˆ†å—è¯»å–...
[2026-02-16 01:57:14,645][root][INFO] - è¯»å–æ•°æ® å®Œæˆ! æ•°æ®å½¢çŠ¶: (636607, 55)
[2026-02-16 01:57:14,649][root][INFO] - æ•°æ®åˆ’åˆ†æ¨¡å¼ï¼šflow
[2026-02-16 01:57:14,650][root][INFO] - ä½¿ç”¨åŸºäº flow_df çš„é€æµåˆ’åˆ†ç­–ç•¥ | éšæœºæ‰“ä¹±: False
[2026-02-16 01:57:14,650][root][INFO] - æ‰§è¡Œä¸¥æ ¼æ—¶åºåˆ‡ç‰‡åˆ’åˆ† (Sequential Split - No Shuffle)...
[2026-02-16 01:57:14,656][root][INFO] -   Train: 1499082958.598308 -> 1499449906.904816
[2026-02-16 01:57:14,656][root][INFO] -   Test : 1499450099.842705 -> 1499457759.567285
[2026-02-16 01:57:14,656][root][INFO] - >>>> åˆ›å»ºè®­ç»ƒé›†MultiviewFlowDataset ...
[2026-02-16 01:57:14,659][root][INFO] - å¯ç”¨åºåˆ—ç‰¹å¾è§†å›¾
[2026-02-16 01:57:14,659][root][INFO] - æ–‡æœ¬ç‰¹å¾æœªé…ç½®ï¼Œè·³è¿‡è¯¥è§†å›¾
[2026-02-16 01:57:14,659][root][INFO] - åŸŸååµŒå…¥ç‰¹å¾æœªé…ç½®æˆ–ä¸ºç©ºï¼Œè·³è¿‡è¯¥è§†å›¾
[2026-02-16 01:57:14,659][root][INFO] - é¢„å¤„ç†å¤šè§†å›¾æ•°æ®...
[2026-02-16 02:06:01,715][root][INFO] - åºåˆ—ç‰¹å¾å¤„ç†å®Œæˆï¼Œæ‰€æœ‰åºåˆ—æ•°æ®æœ‰æ•ˆ
[2026-02-16 02:06:30,229][root][INFO] - [Dataset] æ‰€æœ‰ç±»åˆ«åˆ—ï¼ˆ32åˆ—ï¼‰ï¼š['dns.proto', 'dns.qtype', 'dns.rcode_name', 'dns.TC', 'dns.RD', 'dns.RA', 'dns.rejected', 'conn.service', 'conn.proto', 'conn.history', 'ssl.cipher', 'ssl.resumed', 'ssl.established', 'ssl.version', 'ssl.curve', 'ssl.next_protocol', 'ssl.sni_matches_cert', 'x509.cert0.certificate.key_alg', 'x509.cert0.certificate.sig_alg', 'x509.cert0.certificate.key_type', 'x509.cert0.certificate.version', 'x509.cert0.basic_constraints.ca', 'x509.cert1.certificate.key_alg', 'x509.cert1.certificate.sig_alg', 'x509.cert1.certificate.key_type', 'x509.cert1.certificate.version', 'x509.cert1.basic_constraints.ca', 'x509.cert2.certificate.key_alg', 'x509.cert2.certificate.sig_alg', 'x509.cert2.certificate.key_type', 'x509.cert2.certificate.version', 'x509.cert2.basic_constraints.ca']
[2026-02-16 02:06:30,229][root][INFO] - [Dataset] åˆ—åæ¸…æ´—åçš„æœ‰æ•ˆç±»åˆ«åˆ—ï¼ˆ32åˆ—ï¼‰: ['dns_proto', 'dns_qtype', 'dns_rcode_name', 'dns_TC', 'dns_RD', 'dns_RA', 'dns_rejected', 'conn_service', 'conn_proto', 'conn_history', 'ssl_cipher', 'ssl_resumed', 'ssl_established', 'ssl_version', 'ssl_curve', 'ssl_next_protocol', 'ssl_sni_matches_cert', 'x509_cert0_certificate_key_alg', 'x509_cert0_certificate_sig_alg', 'x509_cert0_certificate_key_type', 'x509_cert0_certificate_version', 'x509_cert0_basic_constraints_ca', 'x509_cert1_certificate_key_alg', 'x509_cert1_certificate_sig_alg', 'x509_cert1_certificate_key_type', 'x509_cert1_certificate_version', 'x509_cert1_basic_constraints_ca', 'x509_cert2_certificate_key_alg', 'x509_cert2_certificate_sig_alg', 'x509_cert2_certificate_key_type', 'x509_cert2_certificate_version', 'x509_cert2_basic_constraints_ca']
[2026-02-16 02:10:16,538][root][INFO] - æ•°æ®é¢„å¤„ç†å®Œæˆ
[2026-02-16 02:10:16,542][root][INFO] - [Dataset] attack_family_classes (6): ['DoS', 'DDoS', 'PortScan', 'BruteForce', 'Bot', 'Web Attack']
[2026-02-16 02:10:16,542][root][INFO] - [Dataset] attack_type_classes (10): ['DoS Hulk', 'DoS GoldenEye', 'DoS Slowhttptest', 'DoS slowloris', 'DDoS', 'PortScan', 'FTP-Patator', 'SSH-Patator', 'Bot', 'Web Attack']
[2026-02-16 02:10:16,542][root][INFO] - >>>> åˆ›å»ºéªŒè¯é›†MultiviewFlowDataset ...
[2026-02-16 02:10:16,545][root][INFO] - âœ… ä½¿ç”¨è®­ç»ƒé›†çš„ç±»åˆ«æ˜ å°„ï¼ˆæ˜ å°„å¤§å°: 32ï¼‰
[2026-02-16 02:10:16,545][root][INFO] - å¯ç”¨åºåˆ—ç‰¹å¾è§†å›¾
[2026-02-16 02:10:16,545][root][INFO] - æ–‡æœ¬ç‰¹å¾æœªé…ç½®ï¼Œè·³è¿‡è¯¥è§†å›¾
[2026-02-16 02:10:16,545][root][INFO] - åŸŸååµŒå…¥ç‰¹å¾æœªé…ç½®æˆ–ä¸ºç©ºï¼Œè·³è¿‡è¯¥è§†å›¾
[2026-02-16 02:10:16,545][root][INFO] - é¢„å¤„ç†å¤šè§†å›¾æ•°æ®...
[2026-02-16 02:10:46,135][root][INFO] - åºåˆ—ç‰¹å¾å¤„ç†å®Œæˆï¼Œæ‰€æœ‰åºåˆ—æ•°æ®æœ‰æ•ˆ
[2026-02-16 02:10:46,154][root][INFO] - ä½¿ç”¨è®­ç»ƒé›†çš„ç±»åˆ«æ˜ å°„å’Œæœ‰æ•ˆç±»åˆ«åˆ—åï¼Œè·³è¿‡ç‹¬ç«‹æ˜ å°„è®¡ç®—
[2026-02-16 02:10:48,891][root][INFO] - [Dataset] æ‰€æœ‰ç±»åˆ«åˆ—ï¼ˆ32åˆ—ï¼‰ï¼š['dns.proto', 'dns.qtype', 'dns.rcode_name', 'dns.TC', 'dns.RD', 'dns.RA', 'dns.rejected', 'conn.service', 'conn.proto', 'conn.history', 'ssl.cipher', 'ssl.resumed', 'ssl.established', 'ssl.version', 'ssl.curve', 'ssl.next_protocol', 'ssl.sni_matches_cert', 'x509.cert0.certificate.key_alg', 'x509.cert0.certificate.sig_alg', 'x509.cert0.certificate.key_type', 'x509.cert0.certificate.version', 'x509.cert0.basic_constraints.ca', 'x509.cert1.certificate.key_alg', 'x509.cert1.certificate.sig_alg', 'x509.cert1.certificate.key_type', 'x509.cert1.certificate.version', 'x509.cert1.basic_constraints.ca', 'x509.cert2.certificate.key_alg', 'x509.cert2.certificate.sig_alg', 'x509.cert2.certificate.key_type', 'x509.cert2.certificate.version', 'x509.cert2.basic_constraints.ca']
[2026-02-16 02:10:48,891][root][INFO] - [Dataset] åˆ—åæ¸…æ´—åçš„æœ‰æ•ˆç±»åˆ«åˆ—ï¼ˆ32åˆ—ï¼‰: ['dns_proto', 'dns_qtype', 'dns_rcode_name', 'dns_TC', 'dns_RD', 'dns_RA', 'dns_rejected', 'conn_service', 'conn_proto', 'conn_history', 'ssl_cipher', 'ssl_resumed', 'ssl_established', 'ssl_version', 'ssl_curve', 'ssl_next_protocol', 'ssl_sni_matches_cert', 'x509_cert0_certificate_key_alg', 'x509_cert0_certificate_sig_alg', 'x509_cert0_certificate_key_type', 'x509_cert0_certificate_version', 'x509_cert0_basic_constraints_ca', 'x509_cert1_certificate_key_alg', 'x509_cert1_certificate_sig_alg', 'x509_cert1_certificate_key_type', 'x509_cert1_certificate_version', 'x509_cert1_basic_constraints_ca', 'x509_cert2_certificate_key_alg', 'x509_cert2_certificate_sig_alg', 'x509_cert2_certificate_key_type', 'x509_cert2_certificate_version', 'x509_cert2_basic_constraints_ca']
[2026-02-16 02:10:48,901][root][INFO] - éªŒè¯é›†/æµ‹è¯•é›†å°†ç­‰å¾…è®­ç»ƒé›†ç»Ÿè®¡ä¿¡æ¯æ³¨å…¥åå†å½’ä¸€åŒ–ã€‚
[2026-02-16 02:10:48,901][root][INFO] - æ•°æ®é¢„å¤„ç†å®Œæˆ
[2026-02-16 02:10:48,901][root][INFO] - [Dataset] attack_family_classes (6): ['DoS', 'DDoS', 'PortScan', 'BruteForce', 'Bot', 'Web Attack']
[2026-02-16 02:10:48,901][root][INFO] - [Dataset] attack_type_classes (10): ['DoS Hulk', 'DoS GoldenEye', 'DoS Slowhttptest', 'DoS slowloris', 'DDoS', 'PortScan', 'FTP-Patator', 'SSH-Patator', 'Bot', 'Web Attack']
[2026-02-16 02:10:48,901][root][INFO] - >>>> åˆ›å»ºæµ‹è¯•é›†MultiviewFlowDataset ...
[2026-02-16 02:10:48,904][root][INFO] - âœ… ä½¿ç”¨è®­ç»ƒé›†çš„ç±»åˆ«æ˜ å°„ï¼ˆæ˜ å°„å¤§å°: 32ï¼‰
[2026-02-16 02:10:48,905][root][INFO] - å¯ç”¨åºåˆ—ç‰¹å¾è§†å›¾
[2026-02-16 02:10:48,905][root][INFO] - æ–‡æœ¬ç‰¹å¾æœªé…ç½®ï¼Œè·³è¿‡è¯¥è§†å›¾
[2026-02-16 02:10:48,905][root][INFO] - åŸŸååµŒå…¥ç‰¹å¾æœªé…ç½®æˆ–ä¸ºç©ºï¼Œè·³è¿‡è¯¥è§†å›¾
[2026-02-16 02:10:48,905][root][INFO] - é¢„å¤„ç†å¤šè§†å›¾æ•°æ®...
[2026-02-16 02:12:09,539][root][INFO] - åºåˆ—ç‰¹å¾å¤„ç†å®Œæˆï¼Œæ‰€æœ‰åºåˆ—æ•°æ®æœ‰æ•ˆ
[2026-02-16 02:12:09,566][root][INFO] - ä½¿ç”¨è®­ç»ƒé›†çš„ç±»åˆ«æ˜ å°„å’Œæœ‰æ•ˆç±»åˆ«åˆ—åï¼Œè·³è¿‡ç‹¬ç«‹æ˜ å°„è®¡ç®—
[2026-02-16 02:12:15,221][root][INFO] - [Dataset] æ‰€æœ‰ç±»åˆ«åˆ—ï¼ˆ32åˆ—ï¼‰ï¼š['dns.proto', 'dns.qtype', 'dns.rcode_name', 'dns.TC', 'dns.RD', 'dns.RA', 'dns.rejected', 'conn.service', 'conn.proto', 'conn.history', 'ssl.cipher', 'ssl.resumed', 'ssl.established', 'ssl.version', 'ssl.curve', 'ssl.next_protocol', 'ssl.sni_matches_cert', 'x509.cert0.certificate.key_alg', 'x509.cert0.certificate.sig_alg', 'x509.cert0.certificate.key_type', 'x509.cert0.certificate.version', 'x509.cert0.basic_constraints.ca', 'x509.cert1.certificate.key_alg', 'x509.cert1.certificate.sig_alg', 'x509.cert1.certificate.key_type', 'x509.cert1.certificate.version', 'x509.cert1.basic_constraints.ca', 'x509.cert2.certificate.key_alg', 'x509.cert2.certificate.sig_alg', 'x509.cert2.certificate.key_type', 'x509.cert2.certificate.version', 'x509.cert2.basic_constraints.ca']
[2026-02-16 02:12:15,222][root][INFO] - [Dataset] åˆ—åæ¸…æ´—åçš„æœ‰æ•ˆç±»åˆ«åˆ—ï¼ˆ32åˆ—ï¼‰: ['dns_proto', 'dns_qtype', 'dns_rcode_name', 'dns_TC', 'dns_RD', 'dns_RA', 'dns_rejected', 'conn_service', 'conn_proto', 'conn_history', 'ssl_cipher', 'ssl_resumed', 'ssl_established', 'ssl_version', 'ssl_curve', 'ssl_next_protocol', 'ssl_sni_matches_cert', 'x509_cert0_certificate_key_alg', 'x509_cert0_certificate_sig_alg', 'x509_cert0_certificate_key_type', 'x509_cert0_certificate_version', 'x509_cert0_basic_constraints_ca', 'x509_cert1_certificate_key_alg', 'x509_cert1_certificate_sig_alg', 'x509_cert1_certificate_key_type', 'x509_cert1_certificate_version', 'x509_cert1_basic_constraints_ca', 'x509_cert2_certificate_key_alg', 'x509_cert2_certificate_sig_alg', 'x509_cert2_certificate_key_type', 'x509_cert2_certificate_version', 'x509_cert2_basic_constraints_ca']
[2026-02-16 02:12:15,234][root][INFO] - éªŒè¯é›†/æµ‹è¯•é›†å°†ç­‰å¾…è®­ç»ƒé›†ç»Ÿè®¡ä¿¡æ¯æ³¨å…¥åå†å½’ä¸€åŒ–ã€‚
[2026-02-16 02:12:15,234][root][INFO] - æ•°æ®é¢„å¤„ç†å®Œæˆ
[2026-02-16 02:12:15,235][root][INFO] - [Dataset] attack_family_classes (6): ['DoS', 'DDoS', 'PortScan', 'BruteForce', 'Bot', 'Web Attack']
[2026-02-16 02:12:15,235][root][INFO] - [Dataset] attack_type_classes (10): ['DoS Hulk', 'DoS GoldenEye', 'DoS Slowhttptest', 'DoS slowloris', 'DDoS', 'PortScan', 'FTP-Patator', 'SSH-Patator', 'Bot', 'Web Attack']
[2026-02-16 02:12:15,235][root][INFO] - âœ… æ‰€æœ‰æ•°æ®é›†çš„ç±»åˆ«æ˜ å°„éªŒè¯ä¸€è‡´
[2026-02-16 02:12:15,235][root][INFO] - âœ… é‡æ–°åº”ç”¨æ•°å€¼ç‰¹å¾æ ‡å‡†åŒ–: éªŒè¯é›†ä½¿ç”¨è®­ç»ƒé›†çš„ç»Ÿè®¡ä¿¡æ¯
[2026-02-16 02:12:15,235][root][INFO] -    è¦†ç›–ç‰¹å¾æ•°é‡: 90
[2026-02-16 02:12:46,519][root][INFO] - âœ… é‡æ–°åº”ç”¨æ•°å€¼ç‰¹å¾æ ‡å‡†åŒ–: æµ‹è¯•é›†ä½¿ç”¨è®­ç»ƒé›†çš„ç»Ÿè®¡ä¿¡æ¯
[2026-02-16 02:12:46,520][root][INFO] -    è¦†ç›–ç‰¹å¾æ•°é‡: 90
[2026-02-16 02:14:02,462][root][INFO] - æ•°æ®é›†åˆ’åˆ†: è®­ç»ƒé›† 636288, éªŒè¯é›† 90899, æµ‹è¯•é›† 181797
[2026-02-16 02:14:02,464][root][INFO] - ==========================================
[2026-02-16 02:14:02,540][root][INFO] - [è®­ç»ƒé›†] æ­£æ ·æœ¬=203842, è´Ÿæ ·æœ¬=432446, æ¯”ä¾‹=0.3204
[2026-02-16 02:14:02,553][root][INFO] - [éªŒè¯é›†] æ­£æ ·æœ¬=90121, è´Ÿæ ·æœ¬=778, æ¯”ä¾‹=0.9914
[2026-02-16 02:14:02,560][root][INFO] - ä½¿ç”¨BERTæ¨¡å‹: bert-base-uncased
[2026-02-16 02:14:02,560][root][INFO] - å°è¯•ä»æœ¬åœ°ç¼“å­˜åŠ è½½BERTæ¨¡å‹...
[2026-02-16 02:14:02,710][root][INFO] - æˆåŠŸä»æœ¬åœ°ç¼“å­˜åŠ è½½BERTæ¨¡å‹ï¼Œè®¾ç½®ä¸ºè®­ç»ƒæ¨¡å¼
[2026-02-16 02:14:02,710][root][INFO] - åŠ è½½çš„BERTæ¨¡å‹çš„æ¯ä¸ª token çš„éšè—å‘é‡ç»´åº¦ï¼ˆhidden dimensionï¼‰ï¼šbert_config.hidden_size = 768
[2026-02-16 02:14:02,710][root][INFO] - è§†å›¾å¯ç”¨çŠ¶æ€: æ•°å€¼ç‰¹å¾å‘é‡å¿…é€‰ï¼Œæ•°æ®åŒ…åºåˆ—=True, æ–‡æœ¬=False, åŸŸååµŒå…¥=False
[2026-02-16 02:14:02,710][root][INFO] - è·³è¿‡æ–‡æœ¬ç‰¹å¾ç¼–ç å™¨åˆå§‹åŒ–
[2026-02-16 02:14:02,736][root][INFO] - åˆå§‹åŒ–æ•°æ®åŒ…åºåˆ—ç¼–ç å™¨
[2026-02-16 02:14:02,736][root][INFO] - åŸŸååµŒå…¥ç‰¹å¾é•¿åº¦: 0
[2026-02-16 02:14:02,736][root][INFO] - åˆå§‹åŒ– categorical embedding: dns_proto â†’ 2 ç±»åˆ«
[2026-02-16 02:14:02,736][root][INFO] - åˆå§‹åŒ– categorical embedding: dns_qtype â†’ 2 ç±»åˆ«
[2026-02-16 02:14:02,736][root][INFO] - åˆå§‹åŒ– categorical embedding: dns_rcode_name â†’ 2 ç±»åˆ«
[2026-02-16 02:14:02,737][root][INFO] - åˆå§‹åŒ– categorical embedding: dns_TC â†’ 2 ç±»åˆ«
[2026-02-16 02:14:02,737][root][INFO] - åˆå§‹åŒ– categorical embedding: dns_RD â†’ 2 ç±»åˆ«
[2026-02-16 02:14:02,737][root][INFO] - åˆå§‹åŒ– categorical embedding: dns_RA â†’ 2 ç±»åˆ«
[2026-02-16 02:14:02,737][root][INFO] - åˆå§‹åŒ– categorical embedding: dns_rejected â†’ 2 ç±»åˆ«
[2026-02-16 02:14:02,737][root][INFO] - åˆå§‹åŒ– categorical embedding: conn_service â†’ 19 ç±»åˆ«
[2026-02-16 02:14:02,737][root][INFO] - åˆå§‹åŒ– categorical embedding: conn_proto â†’ 3 ç±»åˆ«
[2026-02-16 02:14:02,737][root][INFO] - åˆå§‹åŒ– categorical embedding: conn_history â†’ 21 ç±»åˆ«
[2026-02-16 02:14:02,737][root][INFO] - åˆå§‹åŒ– categorical embedding: ssl_cipher â†’ 25 ç±»åˆ«
[2026-02-16 02:14:02,737][root][INFO] - åˆå§‹åŒ– categorical embedding: ssl_resumed â†’ 4 ç±»åˆ«
[2026-02-16 02:14:02,737][root][INFO] - åˆå§‹åŒ– categorical embedding: ssl_established â†’ 4 ç±»åˆ«
[2026-02-16 02:14:02,738][root][INFO] - åˆå§‹åŒ– categorical embedding: ssl_version â†’ 5 ç±»åˆ«
[2026-02-16 02:14:02,738][root][INFO] - åˆå§‹åŒ– categorical embedding: ssl_curve â†’ 6 ç±»åˆ«
[2026-02-16 02:14:02,738][root][INFO] - åˆå§‹åŒ– categorical embedding: ssl_next_protocol â†’ 4 ç±»åˆ«
[2026-02-16 02:14:02,738][root][INFO] - åˆå§‹åŒ– categorical embedding: ssl_sni_matches_cert â†’ 4 ç±»åˆ«
[2026-02-16 02:14:02,738][root][INFO] - åˆå§‹åŒ– categorical embedding: x509_cert0_certificate_key_alg â†’ 4 ç±»åˆ«
[2026-02-16 02:14:02,738][root][INFO] - åˆå§‹åŒ– categorical embedding: x509_cert0_certificate_sig_alg â†’ 7 ç±»åˆ«
[2026-02-16 02:14:02,739][root][INFO] - åˆå§‹åŒ– categorical embedding: x509_cert0_certificate_key_type â†’ 4 ç±»åˆ«
[2026-02-16 02:14:02,739][root][INFO] - åˆå§‹åŒ– categorical embedding: x509_cert0_certificate_version â†’ 4 ç±»åˆ«
[2026-02-16 02:14:02,739][root][INFO] - åˆå§‹åŒ– categorical embedding: x509_cert0_basic_constraints_ca â†’ 4 ç±»åˆ«
[2026-02-16 02:14:02,739][root][INFO] - åˆå§‹åŒ– categorical embedding: x509_cert1_certificate_key_alg â†’ 4 ç±»åˆ«
[2026-02-16 02:14:02,739][root][INFO] - åˆå§‹åŒ– categorical embedding: x509_cert1_certificate_sig_alg â†’ 7 ç±»åˆ«
[2026-02-16 02:14:02,739][root][INFO] - åˆå§‹åŒ– categorical embedding: x509_cert1_certificate_key_type â†’ 4 ç±»åˆ«
[2026-02-16 02:14:02,739][root][INFO] - åˆå§‹åŒ– categorical embedding: x509_cert1_certificate_version â†’ 3 ç±»åˆ«
[2026-02-16 02:14:02,739][root][INFO] - åˆå§‹åŒ– categorical embedding: x509_cert1_basic_constraints_ca â†’ 4 ç±»åˆ«
[2026-02-16 02:14:02,739][root][INFO] - åˆå§‹åŒ– categorical embedding: x509_cert2_certificate_key_alg â†’ 4 ç±»åˆ«
[2026-02-16 02:14:02,739][root][INFO] - åˆå§‹åŒ– categorical embedding: x509_cert2_certificate_sig_alg â†’ 6 ç±»åˆ«
[2026-02-16 02:14:02,739][root][INFO] - åˆå§‹åŒ– categorical embedding: x509_cert2_certificate_key_type â†’ 4 ç±»åˆ«
[2026-02-16 02:14:02,739][root][INFO] - åˆå§‹åŒ– categorical embedding: x509_cert2_certificate_version â†’ 3 ç±»åˆ«
[2026-02-16 02:14:02,739][root][INFO] - åˆå§‹åŒ– categorical embedding: x509_cert2_basic_constraints_ca â†’ 4 ç±»åˆ«
[2026-02-16 02:14:02,740][root][INFO] - æ•°å€¼å‹æµç‰¹å¾æ•°: 90
[2026-02-16 02:14:02,740][root][INFO] - æ€»ç±»åˆ«å‹ç‰¹å¾æ•°: 32
[2026-02-16 02:14:02,740][root][INFO] - æ€»ç±»åˆ«å‹ç‰¹å¾ç»´åº¦: 768 * 32 = 24576
[2026-02-16 02:14:02,740][root][INFO] - è¡¨æ ¼æ•°æ®æ€»ç‰¹å¾ç»´åº¦: æ•°å€¼ç‰¹å¾(90) + åŸŸååµŒå…¥(0) + ç±»åˆ«å‹ç‰¹å¾(24576) = 24666
[2026-02-16 02:14:02,836][root][INFO] - åˆå§‹åŒ–è¡¨æ ¼ç‰¹å¾çº¿æ€§æŠ•å½±å±‚: è¾“å…¥ç»´åº¦=24666, è¾“å‡ºç»´åº¦=768
[2026-02-16 02:14:02,836][root][INFO] - æ¨¡å‹ä½¿ç”¨çš„è§†å›¾æ•°é‡: 2
[2026-02-16 02:14:02,836][root][INFO] - å¤šè§†å›¾èåˆæ–¹æ³•: weighted_sum
[2026-02-16 02:14:02,841][root][INFO] - [Fusion Info] ä½¿ç”¨ weighted_sum èåˆï¼Œè¾“å‡ºç»´åº¦ = bert_config.hidden_size = 768
[2026-02-16 02:14:02,841][root][INFO] - is_maliciouså–„æ„/æ¶æ„æµé‡åˆ†ç±»å™¨çš„è¾“å…¥ç»´åº¦: 768 ï¼Œhidden_dims=[256, 128]
[2026-02-16 02:14:02,841][root][INFO] - is_maliciouså–„æ„/æ¶æ„åˆ†ç±»å™¨éšè—å±‚ 1: 768 -> 256
[2026-02-16 02:14:02,842][root][INFO] - is_maliciouså–„æ„/æ¶æ„åˆ†ç±»å™¨éšè—å±‚ 2: 256 -> 128
[2026-02-16 02:14:02,843][root][INFO] - is_malicious åˆ†ç±»å™¨ç»“æ„: input_dim=768 -> hidden_dims=[256, 128] -> output_dim=1 (binary classification)
[2026-02-16 02:14:02,843][root][INFO] - [attack_family] å¯ç”¨ OVR æ”»å‡»å®¶æ—åˆ†ç±»ä»»åŠ¡ï¼Œå…± 6 ä¸ªæ”»å‡»å®¶æ—: ['DoS', 'DDoS', 'PortScan', 'BruteForce', 'Bot', 'Web Attack']
[2026-02-16 02:14:02,843][root][INFO] - [attack_family] åˆ†ç±»å™¨è¾“å…¥ç»´åº¦ = 768 (æ¥è‡ªå¤šè§†å›¾èåˆè¾“å‡º)
[2026-02-16 02:14:02,843][root][INFO] - [attack_family] åˆ†ç±»å™¨éšè—å±‚ 1: 768 -> 256
[2026-02-16 02:14:02,844][root][INFO] - [attack_family] OVR åˆ†ç±»å™¨ç»“æ„æ„å»ºå®Œæˆ: input_dim=768 -> hidden_dims=[256] -> output_dim=6 (OVR, multi-label)
[2026-02-16 02:14:02,844][root][INFO] - [is_malicious] æŸå¤±å‡½æ•°åˆå§‹åŒ–å®Œæˆ: BCEWithLogitsLoss, class_weights=[1.0, 1.0]
[2026-02-16 02:14:02,844][root][INFO] - [attack_family] OVR æŸå¤±å‡½æ•°åˆå§‹åŒ–å®Œæˆ: BCEWithLogitsLoss, class_weights shape=torch.Size([6, 2])
[2026-02-16 02:14:02,845][root][INFO] - ğŸ›¡ï¸ åˆå§‹åŒ–æ¼‚ç§»æ£€æµ‹å™¨: BNDM
[2026-02-16 02:14:02,845][src.concept_drift_detect.adapter][INFO] - ğŸ” Adapter targeted classifier: attack_family_classifier (Mode: multiclass)
[2026-02-16 02:14:02,845][root][INFO] - ğŸ”„ åˆå§‹åŒ–å¢é‡é€‚é…å™¨ (Mode: multiclass)
[2026-02-16 02:14:02,845][root][INFO] - âœ… æ¼‚ç§»æ£€æµ‹å™¨å°±ç»ª: {'algorithm': 'BNDM', 'drift_count_handler': 0, 'total_samples': 0, 'status': 'running', 'window_R_size': 0, 'window_W_size': 0}
[2026-02-16 02:14:02,848][root][INFO] - ğŸ“‚ æ¨¡å‹å°†å¼ºåˆ¶ä¿å­˜è‡³: /tmp/pycharm_project_982/processed_data
[2026-02-16 02:14:02,860][root][INFO] - ğŸš€ å¼€å§‹è®­ç»ƒ...
[2026-02-16 02:14:07,004][root][INFO] - fit é˜¶æ®µæ•°æ®é›†å·²åˆå§‹åŒ–ï¼Œè·³è¿‡é‡å¤setup
[2026-02-16 02:14:10,965][root][INFO] - â„¹ï¸ è®­ç»ƒé˜¶æ®µ: æ¦‚å¿µæ¼‚ç§»ä»…å¤„äºç›‘æµ‹æ¨¡å¼ (Monitoring Only)ï¼Œä¸ä¼šè§¦å‘é€‚åº”ã€‚
[2026-02-16 03:50:56,672][root][INFO] - 
ğŸ“Š [Train End] æ¦‚å¿µæ¼‚ç§»ç›‘æµ‹ç»Ÿè®¡:
{
  "algorithm": "BNDM",
  "drift_count_handler": 2452,
  "total_samples": 500,
  "status": "running",
  "window_R_size": 500,
  "window_W_size": 500
}
[2026-02-16 03:50:57,052][root][INFO] - ğŸ è®­ç»ƒå®Œæˆï¼
[2026-02-16 03:50:57,052][root][INFO] - âœ… æ•è·åˆ°æ¨¡å‹è·¯å¾„: /tmp/pycharm_project_982/processed_data/best-00-0.00-v3.ckpt
[2026-02-16 03:51:00,295][root][INFO] - ğŸ“¦ å·²å°†æ¨¡å‹å½’æ¡£è‡³: /tmp/pycharm_project_982/processed_data/best_model.ckpt
[2026-02-16 03:51:00,295][root][INFO] - ğŸ§ª å¼€å§‹æµ‹è¯• (åŠ è½½: /tmp/pycharm_project_982/processed_data/best_model.ckpt)...
[2026-02-16 03:51:00,864][root][INFO] - ä½¿ç”¨BERTæ¨¡å‹: bert-base-uncased
[2026-02-16 03:51:00,864][root][INFO] - å°è¯•ä»æœ¬åœ°ç¼“å­˜åŠ è½½BERTæ¨¡å‹...
[2026-02-16 03:51:00,975][root][INFO] - æˆåŠŸä»æœ¬åœ°ç¼“å­˜åŠ è½½BERTæ¨¡å‹ï¼Œè®¾ç½®ä¸ºè®­ç»ƒæ¨¡å¼
[2026-02-16 03:51:00,975][root][INFO] - åŠ è½½çš„BERTæ¨¡å‹çš„æ¯ä¸ª token çš„éšè—å‘é‡ç»´åº¦ï¼ˆhidden dimensionï¼‰ï¼šbert_config.hidden_size = 768
[2026-02-16 03:51:00,975][root][INFO] - è§†å›¾å¯ç”¨çŠ¶æ€: æ•°å€¼ç‰¹å¾å‘é‡å¿…é€‰ï¼Œæ•°æ®åŒ…åºåˆ—=True, æ–‡æœ¬=False, åŸŸååµŒå…¥=False
[2026-02-16 03:51:00,975][root][INFO] - è·³è¿‡æ–‡æœ¬ç‰¹å¾ç¼–ç å™¨åˆå§‹åŒ–
[2026-02-16 03:51:00,987][root][INFO] - åˆå§‹åŒ–æ•°æ®åŒ…åºåˆ—ç¼–ç å™¨
[2026-02-16 03:51:00,987][root][INFO] - åŸŸååµŒå…¥ç‰¹å¾é•¿åº¦: 0
[2026-02-16 03:51:00,987][root][INFO] - åˆå§‹åŒ– categorical embedding: dns_proto â†’ 2 ç±»åˆ«
[2026-02-16 03:51:00,987][root][INFO] - åˆå§‹åŒ– categorical embedding: dns_qtype â†’ 2 ç±»åˆ«
[2026-02-16 03:51:00,987][root][INFO] - åˆå§‹åŒ– categorical embedding: dns_rcode_name â†’ 2 ç±»åˆ«
[2026-02-16 03:51:00,987][root][INFO] - åˆå§‹åŒ– categorical embedding: dns_TC â†’ 2 ç±»åˆ«
[2026-02-16 03:51:00,987][root][INFO] - åˆå§‹åŒ– categorical embedding: dns_RD â†’ 2 ç±»åˆ«
[2026-02-16 03:51:00,987][root][INFO] - åˆå§‹åŒ– categorical embedding: dns_RA â†’ 2 ç±»åˆ«
[2026-02-16 03:51:00,987][root][INFO] - åˆå§‹åŒ– categorical embedding: dns_rejected â†’ 2 ç±»åˆ«
[2026-02-16 03:51:00,988][root][INFO] - åˆå§‹åŒ– categorical embedding: conn_service â†’ 19 ç±»åˆ«
[2026-02-16 03:51:00,988][root][INFO] - åˆå§‹åŒ– categorical embedding: conn_proto â†’ 3 ç±»åˆ«
[2026-02-16 03:51:00,988][root][INFO] - åˆå§‹åŒ– categorical embedding: conn_history â†’ 21 ç±»åˆ«
[2026-02-16 03:51:00,988][root][INFO] - åˆå§‹åŒ– categorical embedding: ssl_cipher â†’ 25 ç±»åˆ«
[2026-02-16 03:51:00,988][root][INFO] - åˆå§‹åŒ– categorical embedding: ssl_resumed â†’ 4 ç±»åˆ«
[2026-02-16 03:51:00,988][root][INFO] - åˆå§‹åŒ– categorical embedding: ssl_established â†’ 4 ç±»åˆ«
[2026-02-16 03:51:00,988][root][INFO] - åˆå§‹åŒ– categorical embedding: ssl_version â†’ 5 ç±»åˆ«
[2026-02-16 03:51:00,988][root][INFO] - åˆå§‹åŒ– categorical embedding: ssl_curve â†’ 6 ç±»åˆ«
[2026-02-16 03:51:00,988][root][INFO] - åˆå§‹åŒ– categorical embedding: ssl_next_protocol â†’ 4 ç±»åˆ«
[2026-02-16 03:51:00,988][root][INFO] - åˆå§‹åŒ– categorical embedding: ssl_sni_matches_cert â†’ 4 ç±»åˆ«
[2026-02-16 03:51:00,989][root][INFO] - åˆå§‹åŒ– categorical embedding: x509_cert0_certificate_key_alg â†’ 4 ç±»åˆ«
[2026-02-16 03:51:00,989][root][INFO] - åˆå§‹åŒ– categorical embedding: x509_cert0_certificate_sig_alg â†’ 7 ç±»åˆ«
[2026-02-16 03:51:00,989][root][INFO] - åˆå§‹åŒ– categorical embedding: x509_cert0_certificate_key_type â†’ 4 ç±»åˆ«
[2026-02-16 03:51:00,989][root][INFO] - åˆå§‹åŒ– categorical embedding: x509_cert0_certificate_version â†’ 4 ç±»åˆ«
[2026-02-16 03:51:00,989][root][INFO] - åˆå§‹åŒ– categorical embedding: x509_cert0_basic_constraints_ca â†’ 4 ç±»åˆ«
[2026-02-16 03:51:00,989][root][INFO] - åˆå§‹åŒ– categorical embedding: x509_cert1_certificate_key_alg â†’ 4 ç±»åˆ«
[2026-02-16 03:51:00,989][root][INFO] - åˆå§‹åŒ– categorical embedding: x509_cert1_certificate_sig_alg â†’ 7 ç±»åˆ«
[2026-02-16 03:51:00,989][root][INFO] - åˆå§‹åŒ– categorical embedding: x509_cert1_certificate_key_type â†’ 4 ç±»åˆ«
[2026-02-16 03:51:00,989][root][INFO] - åˆå§‹åŒ– categorical embedding: x509_cert1_certificate_version â†’ 3 ç±»åˆ«
[2026-02-16 03:51:00,989][root][INFO] - åˆå§‹åŒ– categorical embedding: x509_cert1_basic_constraints_ca â†’ 4 ç±»åˆ«
[2026-02-16 03:51:00,989][root][INFO] - åˆå§‹åŒ– categorical embedding: x509_cert2_certificate_key_alg â†’ 4 ç±»åˆ«
[2026-02-16 03:51:00,990][root][INFO] - åˆå§‹åŒ– categorical embedding: x509_cert2_certificate_sig_alg â†’ 6 ç±»åˆ«
[2026-02-16 03:51:00,990][root][INFO] - åˆå§‹åŒ– categorical embedding: x509_cert2_certificate_key_type â†’ 4 ç±»åˆ«
[2026-02-16 03:51:00,990][root][INFO] - åˆå§‹åŒ– categorical embedding: x509_cert2_certificate_version â†’ 3 ç±»åˆ«
[2026-02-16 03:51:00,990][root][INFO] - åˆå§‹åŒ– categorical embedding: x509_cert2_basic_constraints_ca â†’ 4 ç±»åˆ«
[2026-02-16 03:51:00,990][root][INFO] - æ•°å€¼å‹æµç‰¹å¾æ•°: 90
[2026-02-16 03:51:00,990][root][INFO] - æ€»ç±»åˆ«å‹ç‰¹å¾æ•°: 32
[2026-02-16 03:51:00,990][root][INFO] - æ€»ç±»åˆ«å‹ç‰¹å¾ç»´åº¦: 768 * 32 = 24576
[2026-02-16 03:51:00,990][root][INFO] - è¡¨æ ¼æ•°æ®æ€»ç‰¹å¾ç»´åº¦: æ•°å€¼ç‰¹å¾(90) + åŸŸååµŒå…¥(0) + ç±»åˆ«å‹ç‰¹å¾(24576) = 24666
[2026-02-16 03:51:01,063][root][INFO] - åˆå§‹åŒ–è¡¨æ ¼ç‰¹å¾çº¿æ€§æŠ•å½±å±‚: è¾“å…¥ç»´åº¦=24666, è¾“å‡ºç»´åº¦=768
[2026-02-16 03:51:01,064][root][INFO] - æ¨¡å‹ä½¿ç”¨çš„è§†å›¾æ•°é‡: 2
[2026-02-16 03:51:01,064][root][INFO] - å¤šè§†å›¾èåˆæ–¹æ³•: weighted_sum
[2026-02-16 03:51:01,069][root][INFO] - [Fusion Info] ä½¿ç”¨ weighted_sum èåˆï¼Œè¾“å‡ºç»´åº¦ = bert_config.hidden_size = 768
[2026-02-16 03:51:01,069][root][INFO] - is_maliciouså–„æ„/æ¶æ„æµé‡åˆ†ç±»å™¨çš„è¾“å…¥ç»´åº¦: 768 ï¼Œhidden_dims=[256, 128]
[2026-02-16 03:51:01,069][root][INFO] - is_maliciouså–„æ„/æ¶æ„åˆ†ç±»å™¨éšè—å±‚ 1: 768 -> 256
[2026-02-16 03:51:01,070][root][INFO] - is_maliciouså–„æ„/æ¶æ„åˆ†ç±»å™¨éšè—å±‚ 2: 256 -> 128
[2026-02-16 03:51:01,070][root][INFO] - is_malicious åˆ†ç±»å™¨ç»“æ„: input_dim=768 -> hidden_dims=[256, 128] -> output_dim=1 (binary classification)
[2026-02-16 03:51:01,070][root][INFO] - [attack_family] å¯ç”¨ OVR æ”»å‡»å®¶æ—åˆ†ç±»ä»»åŠ¡ï¼Œå…± 6 ä¸ªæ”»å‡»å®¶æ—: ['DoS', 'DDoS', 'PortScan', 'BruteForce', 'Bot', 'Web Attack']
[2026-02-16 03:51:01,070][root][INFO] - [attack_family] åˆ†ç±»å™¨è¾“å…¥ç»´åº¦ = 768 (æ¥è‡ªå¤šè§†å›¾èåˆè¾“å‡º)
[2026-02-16 03:51:01,070][root][INFO] - [attack_family] åˆ†ç±»å™¨éšè—å±‚ 1: 768 -> 256
[2026-02-16 03:51:01,071][root][INFO] - [attack_family] OVR åˆ†ç±»å™¨ç»“æ„æ„å»ºå®Œæˆ: input_dim=768 -> hidden_dims=[256] -> output_dim=6 (OVR, multi-label)
[2026-02-16 03:51:01,071][root][INFO] - [is_malicious] æŸå¤±å‡½æ•°åˆå§‹åŒ–å®Œæˆ: BCEWithLogitsLoss, class_weights=[1.0, 1.0]
[2026-02-16 03:51:01,071][root][INFO] - [attack_family] OVR æŸå¤±å‡½æ•°åˆå§‹åŒ–å®Œæˆ: BCEWithLogitsLoss, class_weights shape=torch.Size([6, 2])
[2026-02-16 03:51:01,072][root][INFO] - ğŸ›¡ï¸ åˆå§‹åŒ–æ¼‚ç§»æ£€æµ‹å™¨: BNDM
[2026-02-16 03:51:01,072][src.concept_drift_detect.adapter][INFO] - ğŸ” Adapter targeted classifier: attack_family_classifier (Mode: multiclass)
[2026-02-16 03:51:01,072][root][INFO] - ğŸ”„ åˆå§‹åŒ–å¢é‡é€‚é…å™¨ (Mode: multiclass)
[2026-02-16 03:51:01,602][root][INFO] - test é˜¶æ®µæ•°æ®é›†å·²åˆå§‹åŒ–ï¼Œè·³è¿‡é‡å¤setup
[2026-02-16 03:51:01,622][root][INFO] - ğŸ”§ [Test Phase] æ¼‚ç§»æ£€æµ‹å™¨å·²é‡ç½®ï¼Œå‡†å¤‡è¿›è¡Œåœ¨çº¿æ£€æµ‹ä¸é€‚åº”
[2026-02-16 03:51:03,426][root][ERROR] - âŒ è®­ç»ƒå¤±è´¥: 'FlowBertMultiview' object has no attribute 'test_attack_family_probs'
Traceback (most recent call last):
  File "/tmp/pycharm_project_982/src/models/flow_bert_multiview/train.py", line 247, in main
    trainer_test.test(best_model, datamodule=datamodule)
  File "/root/anaconda3/envs/TangYuJie_cuda121/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 821, in test
    return call._call_and_handle_interrupt(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/TangYuJie_cuda121/lib/python3.12/site-packages/pytorch_lightning/trainer/call.py", line 49, in _call_and_handle_interrupt
    return trainer_fn(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/TangYuJie_cuda121/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 864, in _test_impl
    results = self._run(model, ckpt_path=ckpt_path, weights_only=weights_only)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/TangYuJie_cuda121/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 1079, in _run
    results = self._run_stage()
              ^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/TangYuJie_cuda121/lib/python3.12/site-packages/pytorch_lightning/trainer/trainer.py", line 1116, in _run_stage
    return self._evaluation_loop.run()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/TangYuJie_cuda121/lib/python3.12/site-packages/pytorch_lightning/loops/utilities.py", line 179, in _decorator
    return loop_run(self, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/TangYuJie_cuda121/lib/python3.12/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 146, in run
    self._evaluation_step(batch, batch_idx, dataloader_idx, dataloader_iter)
  File "/root/anaconda3/envs/TangYuJie_cuda121/lib/python3.12/site-packages/pytorch_lightning/loops/evaluation_loop.py", line 441, in _evaluation_step
    output = call._call_strategy_hook(trainer, hook_name, *step_args)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/TangYuJie_cuda121/lib/python3.12/site-packages/pytorch_lightning/trainer/call.py", line 329, in _call_strategy_hook
    output = fn(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/TangYuJie_cuda121/lib/python3.12/site-packages/pytorch_lightning/strategies/strategy.py", line 425, in test_step
    return self.lightning_module.test_step(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp/pycharm_project_982/src/models/flow_bert_multiview/models/flow_bert_multiview.py", line 1946, in test_step
    outputs = self._shared_step(batch, batch_idx, stage="test", return_outputs=True)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp/pycharm_project_982/src/models/flow_bert_multiview/models/flow_bert_multiview.py", line 1741, in _shared_step
    self._compute_and_log_attack_family_batch_metrics(stage, outputs, batch, batch_size)
  File "/tmp/pycharm_project_982/src/models/flow_bert_multiview/models/flow_bert_multiview.py", line 1844, in _compute_and_log_attack_family_batch_metrics
    self.test_attack_family_probs.append(attack_family_probs.detach().cpu())
    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/root/anaconda3/envs/TangYuJie_cuda121/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1729, in __getattr__
    raise AttributeError(f"'{type(self).__name__}' object has no attribute '{name}'")
AttributeError: 'FlowBertMultiview' object has no attribute 'test_attack_family_probs'. Did you mean: 'test_attack_family_preds'?
