defaults:
  # åŠ è½½æ•°æ®é›†çš„å…·ä½“é…ç½®
  - datasets: cic_ids_2017 # å¯é€‰ï¼š cic_iomt_2024 | cic_ids_2017
  - _self_

# è°ƒè¯•é…ç½®
debug:
  debug_mode: true  # æ–°å¢ï¼šå¯ç”¨è°ƒè¯•æ¨¡å¼ï¼Œå¯ä»¥æ ¡éªŒæ•°æ®çš„nanæƒ…å†µ

force_single_gpu: false  # æ–°å¢ï¼šæ˜¯å¦å¼ºåˆ¶ä½¿ç”¨å•GPUè¿›è¡Œè®­ç»ƒ

# æ•°æ®é…ç½®
data:
  dataset: ${datasets.name} # é€‰æ‹©æ•°æ®é›†åç§°
  # æµæ•°æ®æ–‡ä»¶è·¯å¾„
  flow_data_path: "${dataset.${dataset.name}.flow_data_path}"
  batch_size: 32  # âœ… ä»32å¢åŠ åˆ°256ï¼Œç”šè‡³512ï¼ˆA800å¯æ”¯æŒæ›´å¤§ï¼Œåˆ°1024ï¼›åœ¨2080tiï¼Œåªèƒ½è®¾ç½®åˆ°32ï¼›ï¼‰
  # âœ… ä»4å¢åŠ åˆ°8ï¼Œå¯ä»¥å……åˆ†åˆ©ç”¨CPUã€‚å¦‚æœé‡åˆ°ç¨‹åºoomæŠ¥é”™æ—¶ï¼Œå¯ä»¥é€‚å½“å‡å°‘ï¼›ä¹‹å‰è®¾ç½®12ï¼Œåœ¨æ˜“å®‰è”å…¬å¸æœåŠ¡å™¨ä¸Šé‡åˆ°å¦‚ä¸‹é—®é¢˜ã€‚
  # åˆ°ä½ ç°åœ¨çš„é—®é¢˜ä¸æ˜¯æ˜¾å­˜ä¸å¤Ÿï¼Œè€Œæ˜¯è®­ç»ƒç­–ç•¥è¿‡åº¦ä¾èµ–ä¸»å†…å­˜ï¼ˆå¾ˆå¸¸è§äºå¤§å‹åºåˆ—æ•°æ®ï¼‰ï¼›
  # 1024 batch Ã— 12 workers Ã— 512 seq Ã— embedding Ã— graphğŸ”¥ æœ€é«˜å¯è¾¾ 150GB+ å†…å­˜
  # æˆ‘æŠŠnum_workersä»12é™ä½åˆ°6ï¼Œä»¥åå°±æ²¡è¿™ä¸ªoomçš„é—®é¢˜äº†ã€‚
  num_workers: 2
  random_state: 42  
  max_seq_length: 512  # BERTæ¨¡å‹æœ€å¤§tokenæ•°ï¼šæœŸæœ›æ˜¯æ—¢æ§åˆ¶sequenceç‰¹å¾çš„é•¿åº¦ï¼Œä¹Ÿæ§åˆ¶æ–‡æœ¬ç‰¹å¾çš„æœ€å¤§tokenæ•°é‡ã€‚ä½†æ˜¯åè€…å¾ˆéš¾å®ç°ï¼Œå› ä¸ºä¸åŒæ–‡æœ¬çš„tokenæ•°é‡å·®å¼‚è¾ƒå¤§ã€‚
  split_mode: "flow"   # å¯é€‰ï¼š "session" | "flow"

  # æ·»åŠ ç›´æ¥é’ˆå¯¹flow_data_pathæ–‡ä»¶è¿›è¡Œéšæœºåˆ’åˆ†çš„é…ç½®
  flow_split:
    train_ratio: 0.7
    validate_ratio: 0.1
    test_ratio: 0.2

  # æ·»åŠ æ ¹æ®session_split_pathä¼šè¯æ–‡ä»¶ï¼Œè¿›è¡Œflowçš„è®­ç»ƒã€éªŒè¯ã€æµ‹è¯•é›†åˆåˆ’åˆ†é…ç½®
  session_split:
    # ä¼šè¯åˆ’åˆ†æ–‡ä»¶è·¯å¾„
    session_split_path: "${dataset.${dataset.name}.session_split_path}"
    flow_uid_list_column: "flow_uid_list"  # åŒ…å«flow UIDåˆ—è¡¨çš„åˆ—å
    split_column: "split"  # # session_dfä¸­splitåˆ—çš„åå­—
    train_split: "train"  # session_dfä¸­splitåˆ—çš„å€¼
    validate_split: "validate"
    test_split: "test"

  sampling:
    enabled: true
    sample_ratio: 0.2   # åªç”¨ 20% çš„ flow æˆ–è€… sessionï¼Œå–å†³äºsplit_mode æ˜¯ "flow" è¿˜æ˜¯ "session"ã€‚

  # åºåˆ—ç‰¹å¾é…ç½®ï¼ˆå¯é€‰ï¼‰
  sequence_features:
    enabled: true
    # bulk_first_packet_index_vector: "flowmeter.bulk_first_packet_index_vector"  # æ¯ä¸ª bulk ä¸­ç¬¬ä¸€ä¸ªæ•°æ®åŒ…åœ¨æ•´ä¸ªæµæ•°æ®åŒ…åºåˆ—ä¸­çš„ç´¢å¼•ä½ç½®
    bulk_length_vector: "flowmeter.bulk_length_vector"  # æ¯ä¸ª bulk çš„é•¿åº¦ï¼ˆå³åŒ…å«çš„æ•°æ®åŒ…æ•°é‡ï¼‰
    bulk_packet_index: "flowmeter.bulk_packet_index_vector" # æ¯ä¸ªæ•°æ®åŒ…æ‰€å±çš„ bulk ç´¢å¼•ä½ç½®
    packet_direction: "flowmeter.packet_direction_vector" # æ•°æ®åŒ…æ–¹å‘åºåˆ—ç‰¹å¾
    packet_iat: "flowmeter.packet_iat_vector" # æ•°æ®åŒ…åˆ°è¾¾æ—¶é—´é—´éš”åºåˆ—ç‰¹å¾
    packet_timestamp: "flowmeter.packet_timestamp_vector" # æ•°æ®åŒ…æ—¶é—´æˆ³åºåˆ—ç‰¹å¾
    packet_payload: "flowmeter.packet_payload_size_vector"  # æ•°æ®åŒ…è½½è·é•¿åº¦åºåˆ—ç‰¹å¾
    mtu_normalize: 1500   # æ ‡å‡†çš„æ•°æ®åŒ…è½½è·é•¿åº¦æœ€å¤§MTUï¼Œç”¨äº payload å½’ä¸€åŒ–
    
  # åŸŸååµŒå…¥çš„æ¦‚ç‡åˆ—è¡¨ç‰¹å¾ï¼ˆå¯é€‰ï¼‰
  domain_name_embedding_features: 
    enabled: false
    column_list: [
      "ssl.server_name0_freq", "ssl.server_name1_freq", "ssl.server_name2_freq", "ssl.server_name3_freq", "ssl.server_name4_freq", 
      "dns.query0_freq", "dns.query1_freq", "dns.query2_freq", "dns.query3_freq", "dns.query4_freq"
    ]

  # æ–‡æœ¬ç‰¹å¾é…ç½®ï¼ˆå¯é€‰ï¼‰
  text_features:
    enabled: false
    # DNS å­—ç¬¦ä¸²è¯­ä¹‰
    dns_query: "dns.query"
    dns_answers: "dns.answers" # Zeek ä¸­é€šå¸¸æ˜¯ åˆ—è¡¨ç±»å‹ï¼šåŒ…å«è‹¥å¹² DNS::Answer ç»“æ„ï¼Œå…¶ä¸­åŒ…æ‹¬å­—ç¬¦ä¸²åŸŸå / IP åœ°å€ / CNAME é“¾ç­‰

    # SSL å­—ç¬¦ä¸²è¯­ä¹‰
    ssl_server_name: "ssl.server_name"

    # X509 å­—ç¬¦ä¸²è¯­ä¹‰
    cert0_subject: "x509.cert0.certificate.subject"
    cert0_issuer: "x509.cert0.certificate.issuer"
    cert0_san_dns: "x509.cert0.san.dns"
    cert1_subject: "x509.cert1.certificate.subject"
    cert1_issuer: "x509.cert1.certificate.issuer"
    cert1_san_dns: "x509.cert1.san.dns"
    cert2_subject: "x509.cert2.certificate.subject"
    cert2_issuer: "x509.cert2.certificate.issuer"
    cert2_san_dns: "x509.cert2.san.dns"

  tabular_features:
    # ç±»åˆ«å‹ç‰¹å¾é…ç½®
    categorical_features:
      # DNSç±»åˆ«è¯­ä¹‰ï¼ˆå…±7ï¼‰
      - dns.proto # DNS çš„ä¼ è¾“å±‚åè®®ç±»å‹ï¼š"udp" / "tcp"
      - dns.qtype # DNS è®°å½•ç±»å‹çš„ æ•°å€¼ç¼–ç ï¼š1/A, 2/NS, 5/CNAME, 12/PTR, ...
      - dns.rcode_name
      - dns.TC 
      - dns.RD
      - dns.RA
      - dns.rejected

      # connç±»åˆ«è¯­ä¹‰ï¼ˆå…±3ï¼‰
      - conn.service
      - conn.proto
      - conn.history # å»ºè®® top-K=20ï¼šä¼šè¯çŠ¶æ€åºåˆ—ï¼Œå¦‚ ShADdï¼Œæ˜¯çŸ­å­—ç¬¦åºåˆ—ï¼Œä½†è¯­ä¹‰ç¦»æ•£ï¼Œé€‚åˆ categorical è€Œé text

      # sslç±»åˆ«è¯­ä¹‰ï¼ˆå…±7ï¼‰
      - ssl.cipher # top-K=50ï¼šåŠ å¯†å¥—ä»¶æ ‡è¯†ï¼Œå¦‚ TLS_AES_128_GCM_SHA256
      - ssl.resumed
      - ssl.established
      - ssl.version # top-K=3
      - ssl.curve
      - ssl.next_protocol
      - ssl.sni_matches_cert 

      # x509 ç±»åˆ«è¯­ä¹‰ï¼ˆå…±3x5=15ï¼‰
      - x509.cert0.certificate.key_alg
      - x509.cert0.certificate.sig_alg
      - x509.cert0.certificate.key_type
      - x509.cert0.certificate.version
      - x509.cert0.basic_constraints.ca

      - x509.cert1.certificate.key_alg
      - x509.cert1.certificate.sig_alg
      - x509.cert1.certificate.key_type
      - x509.cert1.certificate.version
      - x509.cert1.basic_constraints.ca
      
      - x509.cert2.certificate.key_alg
      - x509.cert2.certificate.sig_alg
      - x509.cert2.certificate.key_type
      - x509.cert2.certificate.version
      - x509.cert2.basic_constraints.ca

    # æ•°å€¼å‹ç‰¹å¾é…ç½®
    numeric_features:
      x509_features: [
        "x509.cert0.certificate.key_length",  # RSA/EC å¯†é’¥é•¿åº¦
        "x509.cert0.certificate.exponent",  # RSA public exponentï¼ˆå¸¸è§ 65537ï¼‰
        "x509.cert1.certificate.key_length",
        "x509.cert1.certificate.exponent",
        "x509.cert2.certificate.key_length",
        "x509.cert2.certificate.exponent",
      ]
      dns_features: ["dns.rtt"]
      # flowçº§çš„ç»Ÿè®¡ç‰¹å¾ï¼ˆå¿…é€‰ï¼‰
      flow_features: [
        "conn.missed_bytes", # å› ä¸ºä¸¢åŒ…ã€æŠ“å–ä¸è¶³æˆ–ä¼šè¯é‡ç»„å¤±è´¥è€Œæœªæ•è·çš„æ•°æ®å­—èŠ‚æ•°ï¼›æ”»å‡»æµé‡çš„ä¸¢åŒ…ç‡é€šå¸¸æ›´é«˜ï¼ˆæµæ§ã€ç«¯å£æ‰«æã€DoSã€C2ï¼‰
        "flowmeter.flow_duration", "flowmeter.fwd_pkts_tot", "flowmeter.bwd_pkts_tot",
        "flowmeter.fwd_data_pkts_tot", "flowmeter.bwd_data_pkts_tot", 
        "flowmeter.fwd_pkts_per_sec", "flowmeter.bwd_pkts_per_sec", 
        "flowmeter.flow_pkts_per_sec", "flowmeter.down_up_ratio",
        "flowmeter.fwd_header_size_tot", "flowmeter.fwd_header_size_min", 
        "flowmeter.fwd_header_size_max", "flowmeter.bwd_header_size_tot",
        "flowmeter.bwd_header_size_min", "flowmeter.bwd_header_size_max",
        "flowmeter.flow_FIN_flag_count", "flowmeter.flow_SYN_flag_count",
        "flowmeter.flow_RST_flag_count", "flowmeter.fwd_PSH_flag_count",
        "flowmeter.bwd_PSH_flag_count", "flowmeter.flow_ACK_flag_count",
        "flowmeter.fwd_URG_flag_count", "flowmeter.bwd_URG_flag_count",
        "flowmeter.flow_CWR_flag_count", "flowmeter.flow_ECE_flag_count",
        "flowmeter.fwd_pkts_payload.min", "flowmeter.fwd_pkts_payload.max",
        "flowmeter.fwd_pkts_payload.tot", "flowmeter.fwd_pkts_payload.avg",
        "flowmeter.fwd_pkts_payload.std", "flowmeter.bwd_pkts_payload.min",
        "flowmeter.bwd_pkts_payload.max", "flowmeter.bwd_pkts_payload.tot",
        "flowmeter.bwd_pkts_payload.avg", "flowmeter.bwd_pkts_payload.std",
        "flowmeter.flow_pkts_payload.min", "flowmeter.flow_pkts_payload.max",
        "flowmeter.flow_pkts_payload.tot", "flowmeter.flow_pkts_payload.avg",
        "flowmeter.flow_pkts_payload.std", "flowmeter.payload_bytes_per_second",
        "flowmeter.fwd_iat.min", "flowmeter.fwd_iat.max", "flowmeter.fwd_iat.tot",
        "flowmeter.fwd_iat.avg", "flowmeter.fwd_iat.std", "flowmeter.bwd_iat.min",
        "flowmeter.bwd_iat.max", "flowmeter.bwd_iat.tot", "flowmeter.bwd_iat.avg",
        "flowmeter.bwd_iat.std", "flowmeter.flow_iat.min", "flowmeter.flow_iat.max",
        "flowmeter.flow_iat.tot", "flowmeter.flow_iat.avg", "flowmeter.flow_iat.std", 
        "flowmeter.fwd_subflow_pkts", "flowmeter.bwd_subflow_pkts",
        "flowmeter.fwd_subflow_bytes", "flowmeter.bwd_subflow_bytes",
        "flowmeter.fwd_bulk_bytes", "flowmeter.bwd_bulk_bytes",
        "flowmeter.fwd_bulk_packets", "flowmeter.bwd_bulk_packets",
        "flowmeter.fwd_bulk_rate", "flowmeter.bwd_bulk_rate",
        "flowmeter.num_fwd_bulks", "flowmeter.num_bwd_bulks",
        "flowmeter.active.min", "flowmeter.active.max", "flowmeter.active.tot",
        "flowmeter.active.avg", "flowmeter.active.std", "flowmeter.idle.min",
        "flowmeter.idle.max", "flowmeter.idle.tot", "flowmeter.idle.avg",
        "flowmeter.idle.std", "flowmeter.fwd_init_window_size",
        "flowmeter.bwd_init_window_size", "flowmeter.fwd_last_window_size",
        "flowmeter.bwd_last_window_size"
      ]

  # æ ‡ç­¾åˆ—é…ç½®
  is_malicious_column: "is_malicious"  # äºŒåˆ†ç±»ï¼š0è¡¨ç¤ºå–„æ„ï¼Œ1è¡¨ç¤ºæ¶æ„
  multiclass_label_column: "label"  # åŸå§‹æ ‡ç­¾åˆ—ï¼ŒåŒ…å«å¤šåˆ†ç±»æ ‡ç­¾å­—ç¬¦ä¸²


# è¡¨ç¤ºå­¦ä¹ çš„æ¨¡å‹é…ç½®ï¼Œåˆ†ç±»å™¨çš„æ¨¡å‹é…ç½®è§ datasets ä¸‹å„æ•°æ®é›†çš„ yaml æ–‡ä»¶
model:
  # å¤„ç†æ–‡æœ¬ç‰¹å¾çš„BERTæ¨¡å‹é…ç½®
  bert:
    # æˆ– "bert_uncased_L-2_H-128_A-2"ï¼Œâ€œbert_uncased_L-4_H-256_A-4â€ï¼Œæˆ–è€…"bert-base-uncased"
    # â†’ bert_uncased_L-2_H-128_A-2 æ˜¯ä¸€ä¸ª æå°çš„å¾®å‹ BERTï¼ˆMiniBERTï¼‰
    # â†’ bert_uncased_L-4_H-256_A-4 æ¯” MiniBERT å¼ºå¾ˆå¤šï¼Œä½†è¿œæ¯” BERT-base è½»ã€‚è²Œä¼¼åœ¨Nvidia A800çš„æœåŠ¡å™¨ä¸ŠæŠ¥é”™pytorchç‰ˆæœ¬ä½ã€‚
    # â†’ bert-base-uncased æ˜¯åŸç‰ˆæ ‡å‡† BERTã€‚
    model_name: "bert-base-uncased"    
    # model_name: "bert_uncased_L-2_H-128_A-2"
    # model_name: "bert_uncased_L-4_H-256_A-4"   #qinyf 11-23  24:55
    hidden_dropout_prob: 0.1
    attention_probs_dropout_prob: 0.1

  # æ•°æ®åŒ…åºåˆ—å¤„ç†é…ç½®
  sequence:
    embedding_dim: 256  # embedding_dimå¯ä»¥ç‹¬ç«‹äº BERT çš„éšè—å±‚å¤§å°è¿›è¡Œè°ƒä¼˜
    num_layers: 4
    num_heads: 8
    dropout: 0.1

  # å¤šè§†å›¾é…ç½®ï¼šåºåˆ—ç‰¹å¾ + æ–‡æœ¬ç‰¹å¾ + è¡¨æ ¼ç‰¹å¾ï¼ˆåŸŸååµŒå…¥ç‰¹å¾ + æ•°å€¼ç‰¹å¾ï¼‰ï¼Œå³tabular/sequence/text ä¸‰ä¸ªè§†å›¾
  multiview:
    # å¤šè§†å›¾èåˆæ–¹æ³•é…ç½®
    fusion:
      method: "weighted_sum"  # å¯é€‰: "concat"ï¼ˆæ‹¼æ¥ï¼‰, "cross_attention"ï¼ˆäº¤å‰æ³¨æ„åŠ›ï¼‰, "weighted_sum"ï¼ˆåŠ æƒæ±‚å’Œï¼‰
      cross_attention_heads: 8
      cross_attention_dropout: 0.1

      # åŠ æƒæ±‚å’Œæ–¹æ³•é…ç½®
      weighted_sum:
        learnable_weights: true  # æ˜¯å¦å­¦ä¹ æƒé‡
        initial_weights: [0.33, 0.33, 0.33]  # åˆå§‹æƒé‡

# æ•°æ®é›†é…ç½®
datasets:
  CIC-IoMT-2024:
    flow_data_path: "/root/autodl-fs/processed_data/CIC-IoMT-2024-session-srcIP_srcPort_dstIP_dstPort_proto/all_embedded_flow.csv"
    session_split_path: "/root/autodl-fs/processed_data/CIC-IoMT-2024-session-srcIP_srcPort_dstIP_dstPort_proto/all_split_session.csv"
    # CIC-IoMT-2024æ•°æ®é›†ç±»åˆ«ä¸å‡è¡¡ï¼Œéœ€åŠ æƒ
    # ç±»åˆ«      æ•°é‡        å æ¯”
    # Benign    55,594     0.87%
    # Malicious 6,383,309 99.13%
    class_weights: [114.8, 1.0]

  CIC-IDS-2017:
    flow_data_path: "/root/autodl-fs/processed_data/CIC-IDS-2017-session-srcIP_srcPort_dstIP_dstPort_proto/all_embedded_flow.csv"
    session_split_path: "/root/autodl-fs/processed_data/CIC-IDS-2017-session-srcIP_srcPort_dstIP_dstPort_proto/all_split_session.csv"
    # CIC-IDS-2017æ•°æ®é›†ç±»åˆ«å‡è¡¡ï¼Œæ— éœ€åŠ æƒ
    # ç±»åˆ«      æ•°é‡        å æ¯” 
    # Benign    466,497   51.06% 
    # Malicious 447,080   48.94%
    class_weights: [1.0, 1.0] 

# è®­ç»ƒé…ç½®
training:
  max_epochs: 1 # æ­£å¸¸è®­ç»ƒçš„æ—¶å€™ï¼Œå¯ä»¥è®¾ç½®åˆ°40ï¼›æµ‹è¯•testé˜¶æ®µåŠŸèƒ½çš„æ—¶å€™ï¼Œå¯ä»¥è®¾ç½®åˆ°1ï¼Œè®©è®­ç»ƒé˜¶æ®µå¿«é€Ÿç»“æŸ
  precision: "32-true"  # ä½¿ç”¨32-trueä½ç²¾åº¦é¿å…å…¼å®¹æ€§é—®é¢˜ï¼Œä½¿ç”¨16-mixedæ··åˆç²¾åº¦å¯ä»¥èŠ‚çœæ˜¾å­˜å¹¶åŠ é€Ÿè®­ç»ƒ
  gradient_clip_val: 1.0
  gradient_clip_algorithm: "norm"  # æ·»åŠ è¿™ä¸€è¡Œï¼Œå¯é€‰å€¼: 'norm' | 'value'  
  accumulate_grad_batches: 1 # åœ¨A800æ˜¾å¡ï¼Œmax_seq_lengthç›´æ¥å¤§batchï¼Œæ— éœ€æ¢¯åº¦ç´¯ç§¯
  log_every_n_steps: 10
  strategy: "auto"  # æ·»åŠ è¿™ä¸€è¡Œ
  detect_anomaly: false  # æ·»åŠ è¿™ä¸€è¡Œ  

  # æ¼‚ç§»æ£€æµ‹ç›¸å…³å›è°ƒ
  drift_monitor:
    enabled: true
    check_interval: 50  # æ¯50ä¸ªbatchæ£€æŸ¥ä¸€æ¬¡
    log_to_tensorboard: true
    adaptive_learning_rate: true  # æ¼‚ç§»æ—¶è‡ªé€‚åº”è°ƒæ•´å­¦ä¹ ç‡

  model_checkpoint:
    monitor: "val_is_malicious_f1"
    mode: "max"
    save_top_k: 3
    filename: "best-{epoch:02d}-{val_is_malicious_f1:.2f}"

  early_stopping:
    monitor: "val_is_malicious_f1"
    patience: 8
    mode: "max"
    min_delta: 0.001    

# ä¼˜åŒ–å™¨é…ç½®
optimizer:
  lr: 1e-5  # BERTæ ‡å‡†å­¦ä¹ ç‡
  weight_decay: 0.01
  warmup_ratio: 0.1
  eps: 1e-8
  default_total_steps: 10000

# å­¦ä¹ ç‡è°ƒåº¦å™¨é…ç½®
scheduler:
  type: "linear"  # linear, cosine, constant

# æŸå¤±å‡½æ•°é…ç½®
loss:
  class_weights: ${dataset.${dataset.name}.class_weights}  # æ­£å¸¸/å¼‚å¸¸äºŒåˆ†ç±»ä¸­çš„ç±»åˆ«æƒé‡

concept_drift:
  enabled: false

  # âœ… é€‰æ‹©å½“å‰ä½¿ç”¨çš„æ£€æµ‹å™¨: "bndm", "adwin", "ks" (æœªæ¥æ‰©å±•), æˆ– "ensemble" (æœªæ¥æ‰©å±•)
  # å¦‚æœæƒ³è¿›è¡Œå¯¹æ¯”ï¼Œå¯ä»¥å¼€å¯ shadow_mode
  algorithm: "bndm"

  # âœ… å½±å­æ¨¡å¼ï¼šå¯ç”¨åï¼Œä¸»ç®—æ³•è´Ÿè´£è§¦å‘é€‚åº”ï¼Œå…¶ä»–ç®—æ³•åœ¨åå°è¿è¡Œå¹¶è®°å½•æ—¥å¿—ï¼Œç”¨äºå¯¹æ¯”åˆ†æ
  shadow_mode:
    enabled: true
    algorithms: ["adwin"]  # åœ¨åå°è¿è¡Œçš„å¯¹æ¯”ç®—æ³•åˆ—è¡¨

  # é€šç”¨å‚æ•° (ç”¨äºé¢„å¤„ç†ç‰¹å¾)
  feature_extraction:
    projection_dim: 1     # æŠ•å½±ç»´åº¦
    normalize: true       # æ˜¯å¦åœ¨çº¿å½’ä¸€åŒ–

  # ğŸ›¡ï¸ æ¼‚ç§»é€‚åº”ç­–ç•¥ (å¤šç®¡é½ä¸‹)
  adaptation:
    lr_decay:
      enabled: true
      factor: 0.5         # å­¦ä¹ ç‡è¡°å‡ç³»æ•°
      min_lr: 1e-7

    optimizer_reset:      # æ¸…ç©ºåŠ¨é‡ï¼Œé€‚åº”æ–°åˆ†å¸ƒ
      enabled: true

    window_reset:         # é‡ç½®æ£€æµ‹å™¨çª—å£
      enabled: true

  # === å„ç®—æ³•ç‰¹å®šå‚æ•° ===
  detectors:
    bndm:
      window_size: 500
      threshold: 0.15      # B < threshold è§¦å‘
      max_tree_level: 4
      min_samples: 100
      polya_c: 1.0
      drift_type: "sudden"

    adwin:
      delta: 0.002         # æ•æ„Ÿåº¦ï¼Œè¶Šå°è¶Šä¸æ•æ„Ÿ
      clock: 32            # æ£€æŸ¥é¢‘ç‡

    ks_win:                # Kolmogorov-Smirnov Window (ç¤ºä¾‹)
      window_size: 500
      alpha: 0.005


# æ—¥å¿—é…ç½®
logging:
  save_dir: ${hydra:runtime.cwd}/logs
  name: "flow_bert_multiview"
  version: ${now:%Y-%m-%d_%H-%M-%S}

# SHAPæ¨¡å‹å¯è§£é‡Šæ€§åˆ†æé…ç½® added by qinyf 11-23 24:55 for shap analysis
shap:
  enable_shap: false
  analysis_frequency: 5  # æ¯5ä¸ªepochåˆ†æä¸€æ¬¡
  output_dir: "./shap_results"
  enabled_strategies: ["numeric", "sequence", "text", "categorical"]
  background_samples: 100  # èƒŒæ™¯æ ·æœ¬æ•°é‡
  max_evals: 500  # æœ€å¤§è¯„ä¼°æ¬¡æ•°