[GENERAL]
# 处理线程数
thread_count = 5

# ==========================================
# 数据集激活配置 - 只需修改这里
# ==========================================
# 在要使用的数据集名称前加上 ACTIVE_ 前缀
ACTIVE_DATASET = CIC-IDS-2017
# ACTIVE_DATASET = CIC-IDS-2018
# ACTIVE_DATASET = CIC-IoMT-2024
# ACTIVE_DATASET = ISCX-VPN-nonVPN-2016
# ACTIVE_DATASET = CIC-AndMal2017
# ACTIVE_DATASET = USTC-TFC2016
# ACTIVE_DATASET = CIC-IoT-2023
# ACTIVE_DATASET = CTU-13

# ==========================================
# 数据集配置定义（所有参数都在配置文件中）
# ==========================================
# https://intrusion-detection.distrinet-research.be/WTMC2021/extended_doc.html
[CIC-IDS-2017]
dataset_name = CIC-IDS-2017
# path_to_dataset = ./dataset/CIC-IDS-2017
path_to_dataset = /root/autodl-fs/CIC-IDS-2017
# plot_data_path = ./processed_data/CIC-IDS-2017-session-srcIP_dstIP
# plot_data_path = ./processed_data/CIC-IDS-2017-session-srcIP_dstIP-test
# plot_data_path = ./processed_data/CIC-IDS-2017-session-srcIP_dstIP_dstPort
# plot_data_path = ./processed_data/CIC-IDS-2017-session-srcIP_srcPort_dstIP_dstPort_proto
plot_data_path = /root/autodl-fs/processed_data/CIC-IDS-2017-session-srcIP_srcPort_dstIP_dstPort_proto
# session_tuple_mode = srcIP_dstIP
# session_tuple_mode = srcIP_dstIP_dstPort
session_tuple_mode = srcIP_srcPort_dstIP_dstPort_proto
session_label_id_map = BENIGN:0, DoS Hulk:1, DoS Slowhttptest:2, DoS slowloris:3, DoS GoldenEye:4, PortScan:5, DDoS:6, FTP-Patator:7, SSH-Patator:8, Bot:9, Web Attack:10, Infiltration:11, Heartbleed:12
concurrent_flow_iat_threshold = 1
sequential_flow_iat_threshold = 1.0

# https://www.unb.ca/cic/datasets/ids-2018.html
# 注意：CIC-IDS-2018数据集的标签与CIC-IDS-2017略有不同，另外Infiltration错误拼写成了Infilteration，而且没有 Scan / PortScan
[CIC-IDS-2018]
dataset_name = CIC-IDS-2018
path_to_dataset = ./dataset/CIC-IDS-2018
# plot_data_path = ./processed_data/CIC-IDS-2018-session-srcIP_dstIP
# plot_data_path = ./processed_data/CIC-IDS-2018-session-srcIP_dstIP-test
# plot_data_path = ./processed_data/CIC-IDS-2018-session-srcIP_dstIP_dstPort
plot_data_path = ./processed_data/CIC-IDS-2018-session-srcIP_srcPort_dstIP_dstPort_proto
# session_tuple_mode = srcIP_dstIP
# session_tuple_mode = srcIP_dstIP_dstPort
session_tuple_mode = srcIP_srcPort_dstIP_dstPort_proto
session_label_id_map = Benign:0, DoS attacks-Hulk:1, DoS attacks-SlowHTTPTest:2, DoS attacks-Slowloris:3, DoS attacks-GoldenEye:4, DDoS attacks-LOIC-HTTP:5, DDOS attack-LOIC-UDP:6, DDOS attack-HOIC:7, Brute Force-Web:8, Brute Force -XSS:9, FTP-BruteForce:10, SSH-Bruteforce:11, SQL Injection:12, Bot:13, Infilteration:14
concurrent_flow_iat_threshold = 1
sequential_flow_iat_threshold = 1.0

[CIC-IoMT-2024]
dataset_name = CIC-IoMT-2024
path_to_dataset = ./dataset/CIC-IoMT-2024
plot_data_path = ./processed_data/CIC-IoMT-2024-session-srcIP_srcPort_dstIP_dstPort_proto
session_tuple_mode = srcIP_srcPort_dstIP_dstPort_proto
session_label_id_map = benign_unknown:0, benign_active:1, benign_broker:2, benign_idle:3, benign_interaction:4, benign_power:5, malicious_arp_spoofing:6, malicious_mqtt-ddos-connect_flood:7, malicious_mqtt-ddos-publish_flood:8, malicious_mqtt-dos-connect_flood:9, malicious_mqtt-dos-publish_flood:10, malicious_mqtt-malformed_data:11, malicious_tcp_ip-ddos-icmp:12, malicious_tcp_ip-ddos-syn:13, malicious_tcp_ip-ddos-tcp:14, malicious_tcp_ip-ddos-udp:15, malicious_tcp_ip-dos-icmp:16, malicious_tcp_ip-dos-syn:17, malicious_tcp_ip-dos-tcp:18, malicious_tcp_ip-dos-udp:19, malicious_recon-os_scan:20, malicious_recon-ping_sweep:21, malicious_recon-port_scan:22, malicious_recon-vulscan:23
concurrent_flow_iat_threshold = 1
sequential_flow_iat_threshold = 1.0

[ISCX-VPN-nonVPN-2016]
dataset_name = ISCX-VPN-nonVPN-2016
path_to_dataset = ./dataset/ISCX-VPN-nonVPN-2016
plot_data_path = ./processed_data/ISCX-VPN-nonVPN-2016-session-srcIP_srcPort_dstIP_dstPort_proto
session_tuple_mode = srcIP_srcPort_dstIP_dstPort_proto
session_label_id_map = NonVPN_aim_chat:0, NonVPN_email:1, NonVPN_facebook_audio:2, NonVPN_facebook_chat:3, NonVPN_facebook_video:4, NonVPN_ftps_up:5, NonVPN_gmailchat:6, NonVPN_hangouts_audio:7, NonVPN_hangouts_chat:8, NonVPN_hangouts_video:9, NonVPN_icq_chat:10, NonVPN_netflix:11, NonVPN_scp:12, NonVPN_scpDown:13, NonVPN_scpUp:14, NonVPN_sftp:15, NonVPN_sftp_down:16, NonVPN_sftp_up:17, NonVPN_skype_audio:18, NonVPN_skype_chat:19, NonVPN_skype_file:20, NonVPN_skype_video:21, NonVPN_spotify:22, NonVPN_vimeo:23, NonVPN_voipbuster:24, NonVPN_youtube:25, VPN_aim_chat:26, VPN_bittorrent:27, VPN_email:28, VPN_facebook_audio:29, VPN_facebook_chat:30, VPN_ftps:31, VPN_hangouts_audio:32, VPN_hangouts_chat:33
concurrent_flow_iat_threshold = 1
sequential_flow_iat_threshold = 1.0

[CIC-AndMal2017]
dataset_name = CIC-AndMal2017
path_to_dataset = ./dataset/CIC-AndMal2017-test
plot_data_path = ./processed_data/CIC-AndMal2017-session-srcIP_dstIP-test
session_tuple_mode = srcIP_dstIP
session_label_id_map = benign:0, adware:1, ransomware:2, scareware:3, smsmalware:4
concurrent_flow_iat_threshold = 1
sequential_flow_iat_threshold = 1.0

[USTC-TFC2016]
dataset_name = USTC-TFC2016
path_to_dataset = ./dataset/USTC-TFC2016
plot_data_path = ./processed_data/USTC-TFC2016
session_tuple_mode = srcIP
session_label_id_map = benign_bittorrent:0, benign_facetime:1, benign_ftp:2, benign_gmail:3, benign_mysql:4, benign_outlook:5, benign_skype:6, benign_smb:7, benign_weibo:8, benign_worldofwarcraft:9, malware_cridex:10, malware_geodo:11, malware_htbot:12, malware_miuref:13, malware_neris:14, malware_nsis-ay:15, malware_shifu:16, malware_tinba:17, malware_virut:18, malware_zeus:19
concurrent_flow_iat_threshold = 1
sequential_flow_iat_threshold = 1.0

[CIC-IoT-2023]
dataset_name = CIC-IoT-2023
path_to_dataset = ./dataset/CIC-IoT-2023
plot_data_path = ./processed_data/CIC-IoT-2023
session_tuple_mode = srcIP_dstIP
session_label_id_map = AUTO_FILL
concurrent_flow_iat_threshold = 1
sequential_flow_iat_threshold = 1.0

[CTU-13]
dataset_name = CTU-13
path_to_dataset = ./dataset/CTU-13
plot_data_path = ./processed_data/CTU-13
session_tuple_mode = srcIP_dstIP
session_label_id_map = AUTO_FILL
concurrent_flow_iat_threshold = 1
sequential_flow_iat_threshold = 1.0

# ==========================================
# 兼容性配置（保持现有API不变）
# ==========================================
# 以下section会根据ACTIVE_DATASET自动填充，保持现有代码兼容性
[PATH]
# 这些值会根据ACTIVE_DATASET自动填充
path_to_dataset = AUTO_FILL
plot_data_path = AUTO_FILL

[SESSION]
# 控制 session_tuple 的组成方式：
# 可选值: "srcIP", "dstIP", "srcIP_dstIP", "srcIP_dstIP_proto", "srcIP_dstIP_dstPort", "srcIP_dstIP_dstPort_proto"
# 对应含义：
#   "srcIP"                  => 一元组 (源IP)
#   "dstIP"                  => 一元组 (目的IP)
#   "srcIP_dstIP"            => 二元组 (源IP, 目标IP)
#   srcIP_dstIP_dstPort      => 三元组 (源IP, 目标IP, 目标端口)
#   "srcIP_dstIP_proto"      => 三元组 (源IP, 目标IP, 协议)
#   "srcIP_dstIP_dstPort_proto" => 四元组 (源IP, 目标IP, 目标端口, 协议) [默认]
#   "srcIP_srcPort_dstIP_dstPort_proto" => 五元组 (源IP, 源端口，目标IP, 目标端口, 协议) [默认]

# 这些值会根据ACTIVE_DATASET自动填充
session_tuple_mode = AUTO_FILL
session_label_id_map = AUTO_FILL
concurrent_flow_iat_threshold = AUTO_FILL
sequential_flow_iat_threshold = AUTO_FILL

# =========================
# 域名层级拆分配置段
# =========================
[DOMAIN_HIERARCHY]
# 域名拆分层级数 (默认5层)
domain_split_levels = 5
# 是否启用域名层级拆分
enable_domain_hierarchy = true
# 层级权重配置 (可选，用于加权合并)
level_weights = 0.1,0.2,0.3,0.2,0.2

[MODEL_PARAMS]
# 根据需求设置，建议不超过512
max_packet_sequence_length = 512
# 或 "bert_uncased_L-2_H-128_A-2"，“bert_uncased_L-4_H-256_A-4”，或者"bert-base-uncased"
# → bert_uncased_L-2_H-128_A-2 是一个 极小的微型 BERT（MiniBERT）
# → bert_uncased_L-4_H-256_A-4 比 MiniBERT 强很多，但远比 BERT-base 轻。貌似在Nvidia A800的服务器上报错pytorch版本低。
# → bert-base-uncased 是原版标准 BERT。
text_encoder_name = bert_uncased_L-2_H-128_A-2
# max_text_length用来限定XXXX_textual_features的合并文本的最大长度，超长的部分会阶段。
# 仅 DNS textual	16–32	query/answer 非常短
# DNS + SSL textual	32–64	SSL subject/issuer 有时较长
# DNS + SSL + X509 textual（你的情况）	64（最均衡）	适中，能保留足够信息，又不会拖慢 BERT
# 你想完整保留 certificate textual	128	更长但速度下降明显
max_text_length = 64
enabled_flow_node_views = {"flow_numeric_features": true, "flow_categorical_features": false, "flow_textual_features": false, "packet_len_seq": true, "packet_iat_seq": true, "domain_probs": true, "ssl_numeric_features": false, "ssl_categorical_features": false, "ssl_textual_features": true, "x509_numeric_features": false, "x509_categorical_features": false, "x509_textual_features": true, "dns_numeric_features": true, "dns_categorical_features": false, "dns_textual_features": true}

# =========================
# 新增训练模式配置段 by Yifei Qin
# =========================
[TRAINING_MODES]
# 5种运行模式: full, pretrain, supervised, single, end2end
mode = end2end

# 预训练视图列表 (逗号分隔)
pretrain_views = flow_statistics,ssl_features,x509_features,dns_features,directed_packet_length_sequence,directed_packet_iat_sequence

# 监督训练阶段是否冻结编码器
freeze_encoders = true

# =========================
# 新增模型架构配置段  
# =========================
[MODEL_ARCHITECTURE]
# 潜在空间维度
latent_dim = 100

# GAT隐藏层维度
gat_hidden = 64

# GAT注意力头数
gat_heads = 1

# 是否使用三路独立GAT (true) 或共享GAT (false)
use_three_gats = true

# =========================
# 新增训练参数配置段
# =========================
[TRAINING_PARAMS]
# 学习率
learning_rate = 6e-4

# 最大训练轮数
max_epoch = 100

# 早停耐心值
patience = 8

# 批次大小
batch_size = 64

# 按节点数打批的最大节点数 (0表示禁用)
max_nodes_per_batch = 20000

# 自编码器损失权重
ae_loss_weight = 0.1

# MLM损失权重  
mlm_loss_weight = 0.05

# 是否使用FP16特征
use_fp16_feats = true

# =========================
# 新增实验管理配置段
# =========================
[EXPERIMENT_MANAGER]
# 实验名称
experiment_name = Multi-view

# 是否保存检查点
save_checkpoints = true

# 是否启用可视化
enable_visualization = true

# 实验描述
experiment_description = 轻量多视图图神经网络训练实验

# =========================
# 新增指标配置段
# =========================
[METRICS]
# 基础分类指标
compute_accuracy = true
compute_precision = true
compute_recall = true
compute_f1_score = true
compute_auc_pr = true

# 宏平均指标
compute_macro_precision = true
compute_macro_recall = true
compute_macro_f1 = true

# 加权平均指标
compute_weighted_precision = true
compute_weighted_recall = true
compute_weighted_f1 = true

# 每类指标
compute_per_class_metrics = true

# 损失指标
compute_train_loss = true
compute_val_loss = true
compute_test_loss = true

# 注意力权重指标
compute_attention_weights = true

# 多视图指标
compute_view_correlation = true
compute_view_quality = true

# 训练效率指标
compute_epoch_time = true
compute_memory_usage = true

# 可视化语言
visualization_language = english